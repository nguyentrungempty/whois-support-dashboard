<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>WHOIS Support Dashboard</title>

<style>
body {
  font-family: Arial;
  background: #0b1320;
  color: white;
  margin: 0;
  padding: 40px;
}

.container {
  max-width: 1100px;
  margin: auto;
  background: #111a2e;
  padding: 30px;
  border-radius: 12px;
}

input {
  width: 70%;
  padding: 12px;
  border-radius: 6px;
  border: none;
}

button {
  padding: 12px 20px;
  background: #2d6cdf;
  border: none;
  color: white;
  border-radius: 6px;
  cursor: pointer;
}

.tabs button {
  margin-right: 8px;
  margin-top: 12px;
  background: #1a253d;
}

.card {
  background: #0e1627;
  padding: 18px;
  margin-top: 15px;
  border-radius: 10px;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
}

.badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
}

.good { background: #1f7a1f; }
.bad { background: #8b1e1e; }
.warn { background: #b8860b; }
</style>
</head>
<body>

<div class="container">
<h2>üîç WHOIS Support Dashboard</h2>

<input id="domain" value="trungnq.xyz">
<button onclick="lookup()">Tra c·ª©u</button>

<div class="tabs">
<button onclick="showTab('whois')">WHOIS</button>
<button onclick="showTab('dns')">DNS</button>
<button onclick="showTab('ip')">IP / Network</button>
<button onclick="showTab('website')">Website</button>
<button onclick="showTab('security')">Security</button>
</div>

<div id="result"></div>
</div>

<script>
let currentData = null;

function showTab(tab) {
  if (!currentData) return;
  render(currentData, tab);
}

async function lookup() {
  const domain = document.getElementById("domain").value;
  document.getElementById("result").innerHTML = "‚è≥ ƒêang tra c·ª©u...";

  const res = await fetch("/api/check?domain=" + domain);
  const data = await res.json();
  currentData = data;
  render(data, "whois");
}

function render(data, tab) {
  const r = document.getElementById("result");

  if (tab === "whois") {
    r.innerHTML = `
      <div class="grid">
        <div class="card">Registrar: ${data.whois.registrar}</div>
        <div class="card">Created: ${data.whois.created}</div>
        <div class="card">Expires: ${data.whois.expires}</div>
        <div class="card">Status: ${(data.whois.status || []).join(", ")}</div>
      </div>
    `;
  }

  if (tab === "ip") {
    r.innerHTML = `
      <div class="grid">
        <div class="card">IP: ${data.ipInfo?.ip || "-"}</div>
        <div class="card">ASN: ${data.ipInfo?.asn || "-"}</div>
        <div class="card">Org: ${data.ipInfo?.org || "-"}</div>
        <div class="card">Country: ${data.ipInfo?.country || "-"}</div>
        <div class="card">Region: ${data.ipInfo?.region || "-"}</div>
        <div class="card">City: ${data.ipInfo?.city || "-"}</div>
      </div>
    `;
  }

  if (tab === "website") {
    r.innerHTML = `
      <div class="grid">
        <div class="card">Title: ${data.website?.title || "-"}</div>
        <div class="card">Server: ${data.website?.server || "-"}</div>
        <div class="card">Powered By: ${data.website?.poweredBy || "-"}</div>
        <div class="card">Response Time: ${data.website?.responseTime || "-"} ms</div>
        <div class="card">HTTPS: ${data.website?.https ? "Yes" : "No"}</div>
        <div class="card">SSL Issuer: ${data.ssl?.issuer || "-"}</div>
        <div class="card">SSL Valid To: ${data.ssl?.valid_to || "-"}</div>
      </div>
    `;
  }

  if (tab === "security") {
    const sec = data.security || {};
    r.innerHTML = `
      <div class="grid">
        <div class="card">HSTS: ${sec.hsts ? "‚úÖ" : "‚ùå"}</div>
        <div class="card">X-Frame-Options: ${sec.xframe ? "‚úÖ" : "‚ùå"}</div>
        <div class="card">XSS Protection: ${sec.xss ? "‚úÖ" : "‚ùå"}</div>
        <div class="card">Content-Type Options: ${sec.contentType ? "‚úÖ" : "‚ùå"}</div>
      </div>
    `;
  }

  if (tab === "dns") {
    let html = "";
    Object.keys(data.dns || {}).forEach(k => {
      html += `
        <div class="card">
          <strong>${k}</strong><br>
          ${JSON.stringify(data.dns[k], null, 2)}
        </div>
      `;
    });
    r.innerHTML = html;
  }
}
</script>

</body>
</html>
